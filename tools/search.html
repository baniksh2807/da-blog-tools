<!DOCTYPE html>
<html lang="en">
  <head>
    <title>HTML Operations Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content="Bulk HTML operations tool for content teams and authors">
    <link rel="stylesheet" href="/tools/search/search.css">
    <!-- Import DA App SDK -->
    <script src="https://da.live/nx/utils/sdk.js" type="module"></script>
    <!-- Project App Logic -->
    <script src="/tools/search/search.js" type="module"></script>
  </head>
  <body>
    <div class="app-container">
      <header class="app-header">
        <div class="header-content">
          <div class="header-main">
            <div class="app-icon">
              <img src="./search/icons/code.svg" alt="HTML Operations" class="icon">
            </div>
            <div class="header-text">
              <h1>HTML Operations Tool</h1>
              <p class="subtitle">Bulk add, delete, and scan HTML elements across pages</p>
            </div>
          </div>
          <div class="header-actions">
            <button class="help-btn" type="button" aria-label="Help & Documentation">
              <img src="./search/icons/help.svg" alt="Help" class="icon">
            </button>
          </div>
        </div>
      </header>

      <main class="app-main">
        <!-- HTML Operations Accordion -->
        <div class="accordion-card expanded">
          <div class="accordion-header" data-accordion-target="html-operations">
            <div class="accordion-header-content">
              <div class="card-icon">
                <img src="./search/icons/code.svg" alt="HTML Operations" class="icon">
              </div>
              <h2>HTML Operations</h2>
            </div>
            <div class="accordion-toggle">
              <img src="./search/icons/chevron-down.svg" alt="Toggle" class="icon accordion-icon">
            </div>
          </div>
          
          <div id="html-operations" class="accordion-content">
            
            <!-- Configuration Section for HTML Operations -->
            <div class="form-section html-ops-config">
              <h4>Configuration</h4>
              <p class="help-text">Configure organization, site, and search paths for HTML operations</p>
              
              <div class="form-group">
                <label for="html-ops-org-site">Organization/Site:</label>
                <input 
                  type="text" 
                  id="html-ops-org-site" 
                  placeholder="/org/site (e.g., /myorg/mysite)"
                  class="form-input"
                >
                <small class="help-text">Enter in format: /organization/site</small>
              </div>

              <div class="form-group">
                <label for="html-ops-search-paths">Search Paths:</label>
                <div class="multi-path-container-ops">
                  <input 
                    type="text" 
                    id="html-ops-search-path-input" 
                    class="form-input path-input"
                    placeholder="Type folder paths (e.g., /blog, /drafts) - Press Enter to add"
                  >
                  <div class="path-tags-ops" id="html-ops-path-tags">
                    <!-- Path tags will be added here -->
                  </div>
                </div>
                <div class="checkbox-option">
                  <label class="checkbox-item">
                    <input type="checkbox" id="html-ops-include-subfolders">
                    <span class="checkbox-label">Include Subfolders</span>
                  </label>
                </div>
                <small class="help-text">Leave empty to scan entire site</small>
              </div>
            </div>

            <hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

            <!-- Scan for Elements Section -->
            <div class="form-section">
              <h4>Scan for Elements</h4>
              <p class="help-text">Find all pages containing elements matching a CSS selector</p>
              
              <div class="form-group">
                <label for="scan-selector">CSS Selector to Find:</label>
                <input 
                  type="text" 
                  id="scan-selector" 
                  placeholder="Enter CSS selector (e.g., .header-article-pro)"
                  class="form-input"
                >
                <small class="help-text">Scan will show all pages containing these elements</small>
              </div>

              <button id="scan-elements-btn" class="btn btn-secondary">
                <img src="./search/icons/search.svg" alt="Scan" class="icon">
                <span>Scan for Elements</span>
              </button>
            </div>

            <hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

            <!-- Add HTML Node Section -->
            <div class="form-section">
              <h4>Add HTML Node</h4>
              <p class="help-text">Add HTML content to pages at a specified location</p>
              
              <div class="form-group">
                <label for="html-content">HTML Content to Add:</label>
                <textarea 
                  id="html-content" 
                  rows="8" 
                  placeholder="Enter HTML to add (e.g., <div class='header-article-pro'>...</div>)"
                  class="form-textarea"
                ></textarea>
              </div>

              <div class="form-group">
                <label for="insert-position">Insert Position:</label>
                <select id="insert-position" class="form-select">
                  <option value="append">Append (at end of target)</option>
                  <option value="prepend">Prepend (at beginning of target)</option>
                  <option value="before">Before (before target element)</option>
                  <option value="after">After (after target element)</option>
                </select>
              </div>

              <div class="form-group">
                <label for="target-selector">Target Selector (optional):</label>
                <input 
                  type="text" 
                  id="target-selector" 
                  placeholder="CSS selector (e.g., main, .content) - leave empty for main/body"
                  class="form-input"
                >
                <small class="help-text">Leave empty to target main content area</small>
              </div>

              <button id="add-html-btn" class="btn btn-primary" disabled>
                <img src="./search/icons/plus.svg" alt="Add" class="icon">
                <span>Add HTML to Selected Files</span>
              </button>
            </div>

            <hr style="margin: 30px 0; border: none; border-top: 1px solid #e0e0e0;">

            <!-- Delete HTML Node Section -->
            <div class="form-section">
              <h4>Delete HTML Node</h4>
              <p class="help-text">Remove HTML elements matching a CSS selector</p>
              
              <div class="form-group">
                <label for="delete-selector">CSS Selector to Delete:</label>
                <input 
                  type="text" 
                  id="delete-selector" 
                  placeholder="Enter CSS selector (e.g., .header-article-pro, #hero)"
                  class="form-input"
                >
                <small class="help-text">All matching elements will be removed from selected files</small>
              </div>

              <button id="delete-html-btn" class="btn btn-danger" disabled>
                <img src="./search/icons/trash.svg" alt="Delete" class="icon">
                <span>Delete Elements from Selected Files</span>
              </button>
            </div>

          </div>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container" style="display: none;">
          <div class="progress-card">
            <div class="progress-content">
              <div class="progress-icon">
                <img src="./search/icons/loading.svg" alt="Progress" class="icon">
              </div>
              <div class="progress-info">
                <div class="progress-text">Processing...</div>
                <div class="progress-bar">
                  <div class="progress-fill"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Results Section -->
        <div class="results-container accordion-card" style="display: none;">
          <div class="card-header accordion-header" data-accordion-target="search-results">
            <div class="card-icon">
              <img src="./search/icons/check.svg" alt="Results" class="icon">
            </div>
            <div class="header-text">
              <h2>Results</h2>
              <div class="results-summary">
                <div class="summary-item">
                  <span class="summary-number" id="files-scanned">0</span>
                  <span class="summary-label">Files Scanned</span>
                </div>
                <div class="summary-item">
                  <span class="summary-number" id="matches-found">0</span>
                  <span class="summary-label">Elements Found</span>
                </div>
                <div class="summary-item">
                  <span class="summary-number" id="files-affected">0</span>
                  <span class="summary-label">Files Affected</span>
                </div>
              </div>
            </div>
            <div class="accordion-toggle">
              <img src="./search/icons/chevron-down.svg" alt="Toggle Results" class="icon accordion-icon">
            </div>
          </div>
          
          <div class="card-content accordion-content" id="search-results" style="display: none;">
            <div class="results-controls">
              <div class="selection-controls">
                <button id="toggle-all" class="btn btn-sm btn-outline">Select All</button>
                <button id="clear-selection" class="btn btn-sm btn-outline">Clear Selection</button>
                <button id="expand-all" class="btn btn-sm btn-outline">Expand All</button>
                <button id="collapse-all" class="btn btn-sm btn-outline">Collapse All</button>
              </div>
              <div class="filter-controls">
                <div class="search-input">
                  <img src="./search/icons/search.svg" alt="Search" class="icon search-icon">
                  <input type="text" id="filter-results" placeholder="Filter by file path..." class="filter-input">
                </div>
              </div>
            </div>
            
            <div class="results-content">
              <div class="results-list" id="results-list">
                <!-- Results will be populated here -->
              </div>
              
              <!-- Pagination Controls -->
              <div class="pagination-container" id="pagination-container" style="display: none;">
                <div class="pagination-info">
                  <span id="pagination-info-text">Showing results</span>
                </div>
                <div class="pagination-controls">
                  <button id="prev-page" class="pagination-btn" disabled>
                    <img src="./search/icons/chevron-left.svg" alt="Previous" class="icon icon-sm">
                    Previous
                  </button>
                  
                  <div class="page-numbers" id="page-numbers">
                    <!-- Page numbers will be populated here -->
                  </div>
                  
                  <button id="next-page" class="pagination-btn">
                    Next
                    <img src="./search/icons/chevron-right.svg" alt="Next" class="icon icon-sm">
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Help Modal -->
        <div id="help-modal" class="modal-overlay hidden">
          <div class="modal-content">
            <div class="modal-header">
              <h2>HTML Operations Tool Help</h2>
              <button class="modal-close" aria-label="Close help">
                <img src="./search/icons/close.svg" alt="Close" class="icon">
              </button>
            </div>
            
            <div class="modal-body">
              <div class="help-section">
                <h3>What is HTML Operations Tool?</h3>
                <p>Bulk HTML manipulation tool for scanning, adding, and removing HTML elements across multiple pages.</p>
              </div>

              <div class="help-section">
                <h3>Key Features</h3>
                <ul class="help-list">
                  <li><strong>Scan for Elements</strong> - Find all pages containing specific CSS selectors</li>
                  <li><strong>Add HTML Nodes</strong> - Insert HTML content at specified locations</li>
                  <li><strong>Delete HTML Nodes</strong> - Remove elements matching CSS selectors</li>
                  <li><strong>Multi-Path Support</strong> - Target specific folders or entire site</li>
                  <li><strong>Automatic Backups</strong> - Creates version backups before modifications</li>
                  <li><strong>Batch Operations</strong> - Process multiple files simultaneously</li>
                </ul>
              </div>

              <div class="help-section">
                <h3>How to Use</h3>
                <div class="help-steps">
                  <div class="help-step">
                    <span class="step-number">1</span>
                    <div class="step-content">
                      <strong>Configure</strong>
                      <p>Set org/site and search paths (leave empty for entire site).</p>
                    </div>
                  </div>
                  <div class="help-step">
                    <span class="step-number">2</span>
                    <div class="step-content">
                      <strong>Scan</strong>
                      <p>Enter CSS selector and scan to find matching elements.</p>
                    </div>
                  </div>
                  <div class="help-step">
                    <span class="step-number">3</span>
                    <div class="step-content">
                      <strong>Execute</strong>
                      <p>Select files and use Add/Delete operations. Backups are created automatically.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Toast Messages -->
        <div class="toast-container">
          <div class="toast hidden" id="toast">
            <div class="toast-content">
              <div class="toast-icon">
                <img src="./search/icons/check.svg" alt="Success" class="icon">
              </div>
              <div class="toast-message"></div>
              <button class="toast-close" aria-label="Close notification">
                <img src="./search/icons/close.svg" alt="Close" class="icon icon-sm">
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>
  </body>
</html>